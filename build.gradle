plugins {
    id 'org.unbroken-dome.test-sets' version '1.2.0'
}

apply plugin: 'java'

sourceCompatibility = 1.8
version = '1-SNAPSHOT'

repositories {
    mavenCentral()
}

testSets {
    integrationTest { dirName = 'it' }
}

dependencies {
    testCompile 'junit:junit:4.12'
    integrationTestCompile 'org.assertj:assertj-core:3.2.0'
}

check.dependsOn integrationTest
integrationTest.mustRunAfter test
project.integrationTest {
    outputs.upToDateWhen { false } // Always run IT
}

// Work around issue #12 in test sets plugin
tasks.withType(Test) {
    reports.html.destination = new File(project.reportsDir, name)
    reports.junitXml.destination \
     = new File(project.buildDir, "${name}-results")
    binResultsDir = new File(reports.junitXml.destination, "binary")
}

// vi: filetype=groovy
